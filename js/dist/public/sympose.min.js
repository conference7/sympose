"use strict";function manage_agenda(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={"X-WP-Nonce":wpApiSettings.nonce};return fetch(wpApiSettings.root+"sympose/v1/update_agenda_sessions",{method:"POST",headers:e,body:JSON.stringify(s)}).then((function(s){return s.json()})).then((function(s){return s}))}function setFavorites(s,e){e.map((function(e){s.dataset.id===e.id&&e.sessions.map((function(e){var t=s.querySelector('.session-row[data-id="'+e+'"]');null!==t&&(t.querySelector(".session-saved").parentNode.dataset.state="on")}))}))}document.addEventListener("DOMContentLoaded",(function(){var s=document.querySelectorAll(".sympose-schedule.event"),e=[];manage_agenda().then((function(t){if(200===t.status){e=t.data;var a=localStorage.getItem("_sympose_saved_sessions");null!==a&&(a=JSON.parse(a)).map((function(s){e.map((function(e){e.id===s.id&&s.sessions.map((function(s){e.sessions.includes(s)||e.sessions.push(s)}))}))})),localStorage.setItem("_sympose_saved_sessions",JSON.stringify(e)),s.forEach((function(s){setFavorites(s,e)}))}})),s.forEach((function(s){e=null===(e=localStorage.getItem("_sympose_saved_sessions"))||""===e?[]:JSON.parse(e),setFavorites(s,e),s.addEventListener("click",(function(e){if(e.target.closest(".saved-sessions-control"))s.querySelectorAll('.session-row[data-state="on"]').length>0&&(s.dataset.showFavorites="true"===s.dataset.showFavorites?"false":"true");else{if(s.closest(".sympose-schedule").classList.contains("updating"))return;var t=e.target.closest(".session-saved");if(null!==t){var a=t.closest("table").dataset.id,n="off";t.parentNode.dataset.state&&"off"!==t.parentNode.dataset.state||(n="on");var o=t.parentNode.dataset.id,i=localStorage.getItem("_sympose_saved_sessions");i=null!==i?JSON.parse(i):[];var d=!1;i.map((function(s){s.id===a&&(d=!0,s.sessions.includes(o)?s.sessions.pop(o):s.sessions.push(o))})),!1===d&&i.push({id:a,sessions:[o]}),localStorage.setItem("_sympose_saved_sessions",JSON.stringify(i)),s.closest(".sympose-schedule").classList.add("updating"),manage_agenda({saved_sessions:i}).then((function(){s.closest(".sympose-schedule").classList.remove("updating"),t.parentNode.dataset.state=n}))}}}))}))}));